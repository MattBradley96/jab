#! /bin/sh

. ~/.jab/environ

export PROMPT_COLOUR=none
if [ "$1" == "green" ]
then
	export PROMPT_COLOUR="$PROMPT_LIGHT_GREEN"
elif [ "$1" == "red" ]
then
	export PROMPT_COLOUR="$PROMPT_LIGHT_RED"
elif [ "$1" == "blue" ]
then
	export PROMPT_COLOUR="$PROMPT_LIGHT_BLUE"
else
	export PROMPT_COLOUR=none
fi

prompt_command ()
{
	if [ -z "$1" ]
	then
		how_do_you_do_nothing_in_a_bash_script=0
	elif [[ $1 == 0 ]]
	then
		export STATUS="${PROMPT_GREEN}$1${PROMPT_NO_COLOUR}"
	else
		export STATUS="${PROMPT_RED}$1${PROMPT_NO_COLOUR}"
	fi
	echo
	echo -ne $STATUS
	j --add "$(pwd -P)"
}

if [[ "$PROMPT_COLOUR" == "none" ]]
then
	export PROMPT_COMMAND=
	export PS1="\$? [\u@\h \W]\n$ "
else
	export PROMPT_COMMAND='prompt_command $?'
	export PS1=" ${PROMPT_COLOUR}[\D{%A %Y-%m-%d.%T} \u@\h \w]${PROMPT_NO_COLOUR}\n$ "
fi

bind '"\e[A"':history-search-backward
bind '"\e[B"':history-search-forward

