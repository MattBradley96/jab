kd is a cd replacer
===================

	>>> import kd

Command Line
------------
kd is intended to be used from the command line
	It parses its arguments with the kd.parse_command_line method

On the command line we expect two arguments: dir and sub-dir
	(Emulating sys.argv here - use a list, not a string)

	>>> kd.parse_command_line(['alan','was'])
	['alan', 'was']

One argument is fine - second will be set to None

	>>> kd.parse_command_line(['alan'])
	['alan', None]


Finding sub-directories
-----------------------
The parsed arguments are sent on to the kd.find_dir method

kd.find_dir will find a directory
	Give it a directory to start on

	>>> kd.find_dir('/usr/lib')
	<path '/usr/lib'>

Give it the name of a (possible) sub directory
	and it will combine them to one path

	>>> kd.find_dir('/usr/local','sbin')
	<path '/usr/local/sbin'>

The sub-dir can be a partial match
	
	>>> kd.find_dir('/usr/local','sbi')
	<path '/usr/local/sbin'>

But if the sub-dir matches too many directories then an exception is raised

	>>> kd.find_dir('/usr/local','bin')
	Traceback (most recent call last):
	...
	NotImplementedError: Too many possiblities:
	    /usr/local/viewvc-1.0-dev/bin
	    /usr/local/viewvc-1.0-dev/lib/vclib/bincvs
	    /usr/local/apr/bin
	    /usr/local/sbin
	...

Change directory
----------------

If kd.find_dir() gave a directory, then the chdir method is used to go there
This method changes the working directory for the rest of the script
	as well as changing env values

	>>> x = kd.find_dir('/usr/local','sbin')
	>>> kd.chdir(x)
	>>> import os
	>>> print os.getcwd()
	/usr/local/sbin
	>>> print os.environ['PWD']
	/usr/local/sbin

Running from bash
-----------------

If run from the command line the python process cannot change dir for calling process (bash)
Hence the script just prints out the result
	bash can then capture that and do the actual cd
main() will return 0 for success, 1 for fail
(We'll redirect sys.stderr here only for cleanliness of output)

	>>> import sys
	>>> sys.stderr = file('/dev/null','a')
	>>> sys.argv = [ 'kd', '/usr/lib/python2.4/', 'altobridge' ]
	>>> kd.main()
	/usr/lib/python2.4/site-packages/altobridge
	0

When main() fails it prints out the current directory
	>>> os.chdir('/etc')
	>>> sys.argv = [ 'kd', '/usr/lib/python2.9/', 'rubbish' ]
	>>> kd.main()
	1
